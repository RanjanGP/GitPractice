lines added from ranjan branch